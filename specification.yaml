  openapi: 3.0.3
  info:
    title: Race service
    description: The race service let you administrate the main domain objects raceplan and races
    version: '1.0'
    license:
        name: Apache 2.0
        url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
  tags:
    - name: race_plan
      description: Race plan operations
  paths:
    /raceplans:
      post:
        tags:
        - race_plan
        security:
        - bearerAuth: []
        description: Add a new race plan
        requestBody:
          description: The new race plan to be created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RacePlan'
        responses:
          201:
            description: Created
      get:
        tags:
        - race_plan
        description: Get a list of race plans
        responses:
          200:
            description: Ok
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/RacePlanCollection'
    /raceplans/{racePlanId}:
      parameters:
      - name: racePlanId
        in: path
        description: race plan id
        required: true
        schema:
          type: string
          format: uuid
      get:
        tags:
        - race_plan
        description: Get a unique race plan
        responses:
          200:
            description: Ok
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/RacePlan'
      put:
        tags:
        - race_plan
        description: Update an race plan
        responses:
          204:
            description: No content
      delete:
        tags:
        - race_plan
        description: Delete a race plan
        responses:
          204:
            description: No content
    /raceplans/generate-raceplan-for-event:
      post:
        tags:
        - race_plan
        security:
        - bearerAuth: []
        description: command to generate race plan based on event
        requestBody:
          description: input data from which to generate the plan
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Input'
        responses:
          201:
            description: Created
  components:
    schemas:
      Input:
        type: object
        description: the composite input object with required information to generate a race plan|
        properties:
          event_id:
            type: string
            description: reference to the event
          competitionFormat:
            type: string
            description: the format of the competition
          startTime:
            type: string
            format: time
            description: the time of day when the event starts
          raceclasses:
            type: array
            items:
              type: object
              properties:
                name:
                  type: string
                  description: name of race class
                order:
                  type: integer
                  description: relative start position in plan
          contestants:
            type: array
            items:
              type: object
              properties:
                bib:
                  type: integer
                raceclass:
                  type: string
                  description: race class name
      RacePlanCollection:
        type: object
        properties:
          events:
            type: array
            items:
              $ref: '#/components/schemas/RacePlan'
      RacePlan:
        properties:
          id:
            type: string
          eventId:
            type: string
            description: reference to the event the plan is for
          races:
            type: array
            items:
              type: str
              description: ref to individual races
    securitySchemes:
      bearerAuth:
        type: http
        scheme: bearer
        bearerFormat: JWT
